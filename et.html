<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>Realistic Earth (non-ESM)</title>
<style>
  body { margin: 0; overflow: hidden; background: black; }
  canvas { display: block; }
</style>
</head>
<body>

<!-- three.js 本体（非ESM） -->
<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>


<script>
//
// ================== 基本セットアップ ==================
//
const scene = new THREE.Scene();

const camera = new THREE.PerspectiveCamera(
  45,
  window.innerWidth / window.innerHeight,
  0.1,
  1000
);
camera.position.set(0, 0, 5);

const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.setPixelRatio(window.devicePixelRatio);
renderer.shadowMap.enabled = true;
renderer.shadowMap.type = THREE.PCFSoftShadowMap;
document.body.appendChild(renderer.domElement);



//
// ================== 太陽光 ==================
//
const sunLight = new THREE.DirectionalLight(0xffffff, 1.5);
sunLight.position.set(5, 2, 5);
sunLight.castShadow = true;
sunLight.shadow.mapSize.width = 2048;
sunLight.shadow.mapSize.height = 2048;
scene.add(sunLight);

scene.add(new THREE.AmbientLight(0x222222));

//
// ================== テクスチャ ==================
//
const loader = new THREE.TextureLoader();

const texDay    = loader.load("earth_day.jpg");
const texNight  = loader.load("earth_night.jpg");
const texNormal = loader.load("earth_normal.jpg");
const texClouds = loader.load("earth_clouds.png");

//
// ================== 地球本体 ==================
//
const earthGeo = new THREE.SphereGeometry(1, 128, 128);

const earthMat = new THREE.MeshStandardMaterial({
  map: texDay,
  normalMap: texNormal,
  roughness: 1,
  metalness: 0,
  emissiveMap: texNight,
  emissive: new THREE.Color(0xffffff),
  emissiveIntensity: 1
});

const earth = new THREE.Mesh(earthGeo, earthMat);
earth.castShadow = true;
earth.receiveShadow = true;
scene.add(earth);

//
// ================== 雲 ==================
//
const cloudGeo = new THREE.SphereGeometry(1.01, 128, 128);
const cloudMat = new THREE.MeshStandardMaterial({
  map: texClouds,
  transparent: true,
  opacity: 0.8,
  depthWrite: false
});
const clouds = new THREE.Mesh(cloudGeo, cloudMat);
scene.add(clouds);

//
// ================== 大気（簡易グロー） ==================
//
const atmoGeo = new THREE.SphereGeometry(1.1, 128, 128);
const atmoMat = new THREE.MeshBasicMaterial({
  color: 0x4da6ff,
  transparent: true,
  opacity: 0.15,
  side: THREE.BackSide
});
const atmosphere = new THREE.Mesh(atmoGeo, atmoMat);
scene.add(atmosphere);

//
// ================== アニメーション ==================
//
function animate() {
  requestAnimationFrame(animate);

  earth.rotation.y += 0.0005;
  clouds.rotation.y += 0.0008;

  
  renderer.render(scene, camera);
}
animate();

//
// ================== リサイズ ==================
//
window.addEventListener("resize", () => {
  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>

</body>
</html>
